import argparse
import json
import random


# returns port number
def gen(arch):
    arch = arch[0]
    file = open("arch.txt", 'r')
    dic = json.loads(file.read())
    file.close()
    if arch not in dic:
        portnum = random.randint(1, 9) * 1000 + random.randint(1, 9) * 100 + random.randint(1, 9) * 10 + random.randint(
            1, 9)
        dic[arch] = portnum
    else:
        portnum = dic[arch]
    open("arch.txt", "w").close()
    file = open("arch.txt", "w")
    file.write(json.dumps(dic))
    file.close()
    print portnum
    return portnum


if __name__ == '__main__':
    parser = argparse.ArgumentParser(description="put in architecture as an argument")
    parser.add_argument("architecture", nargs=1, metavar="arch", help="Add a valid architecture")
    options = parser.parse_args()
    arch = options.architecture
    gen(arch)
